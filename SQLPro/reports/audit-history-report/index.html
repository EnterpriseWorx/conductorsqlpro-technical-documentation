<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../..../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Audit History Report - ConductorSQLPro Technical Documentation</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#_top", children: [
          ]},
          {title: "Alerts", url: "#alerts", children: [
          ]},
          {title: "Exclusions", url: "#exclusions", children: [
          ]},
          {title: "System Settings", url: "#system-settings", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../js/custom.js"></script>
      <script src="../../../search/main.js"></script> 
<link rel="stylesheet" href="../../../css/jquery.fancybox.css" type="text/css" defer />
<script src="../../../js/jquery.fancybox.js" defer></script>
<script src="../../../js/jquery.fancybox.pack.js" defer></script>
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../health-report/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../health-report/" class="btn btn-xs btn-link">
        Health Report
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../overview/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../overview/" class="btn btn-xs btn-link">
        Overview
      </a>
    </div>
    
  </div>

    

    <h1 id="introduction">Introduction</h1>
<p>To get started select the reports icon and choose audit history report:</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-menu.png" /></p>
<p>Here you can see database structural changes made on your whole environment.
This allows you to see if logins, databases, tables, views, indexes etc. are
being added, modified or removed from your servers. You can also set up email
alerts for potentially dangerous operations such as login creation or dropping
databases.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Server activity audit is an option that can be set by editing the instance you would like
to audit. This feature is only available for Microsoft SQL Server and not SQL Azure or another
of the other database types.</p>
</div>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-instance-edit.png" /></p>
<p>And by viewing a script you can see what statements users have run in SQL.</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-screen.png" /></p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-script-view.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the script returns --Encrypted-- then the changes were done by an encrypted stored
procedure and you cannot view the SQL that was changed.</p>
</div>
<h1 id="alerts">Alerts</h1>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-screen.png" /></p>
<p>Clicking on the <strong>Alerts</strong> button will bring you to the <strong>Server Activity
Alerts</strong> screen. Here you can set up alert emails for specific events such as a
table being created or a database being dropped for example</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-alerts-screen.png" /></p>
<p>By clicking the <strong>Add Alert</strong>, you can create a new alert.</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-add-alerts-screen.png" /></p>
<ul>
<li><strong>Alert Name</strong> - A free text name of the alert which affects the email subject
  line, so you can tell from which alert the event fired from.</li>
<li><strong>Email List</strong> - The list of To And CC addresses to send the email to</li>
<li><strong>Is Active</strong> - Turn on or off the Alert</li>
<li><strong>Include Statement in Email</strong> - by default we don't include the actual SQL
  text that was run, turn this on if you would like to see the text.</li>
<li><strong>Event Type</strong> - The list of events that trigger the Alert. e.g. if I select
  DROP_DATABASE, I will get alerted when a user drops a database.</li>
<li><strong>Event Start Date</strong> - this is set to the date that the alert was created, if
  you want to test what emails will be sent you can set this date to a date in
  the past.</li>
<li><strong>Group Name</strong> - here you can limit the alert to a selection of instances that
  are part of a group</li>
<li><strong>Login/Database/Schema/Object Name Like</strong> - Here you can limit the alerts to
  only work with a number of objects with matching like clause. e.g. if I put in
  <strong>Adventure%</strong> for the <strong>Database Name Like</strong> field it would only capture
  events on the matching <strong>AdventureWorks</strong> and <strong>Adventure</strong> databases</li>
<li><strong>Login/Database/Schema/Object Name Not Like</strong> - In the same way as the
  <strong>Like</strong> operators, here you can exclude a specific item from the list. e.g.
  if I have a login called <strong>POSUser</strong> which is allowed to do anything in the
  system and I don't want alerts on anything this user does, I would add
  <strong>POSUser</strong> to the <strong>Login Name Not Like</strong> field.</li>
</ul>
<h1 id="exclusions">Exclusions</h1>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-screen.png" /></p>
<p>Clicking on the <strong>Exclusions</strong> button will bring you to the <strong>Server Activity
Exclusions</strong> screen. Here you can set up specific events that get excluded
altogether in the <strong>Service Activity Audit History</strong>. A good example where this
is useful would be if a destructive load process drops and recreates reporting
tables every day. This allows you filter out "noise" so you can focus on the
important events.</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-exclusion-list.png" /></p>
<p>By default, we exclude some of the objects that are dropped and recreated in
SQLPro's Backup and Maintenance Module.</p>
<p>To add a new exclusion, click on the <strong>Add Exclusion</strong> button.</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-edit-exclusion.png" /></p>
<ul>
<li><strong>Name</strong> - the friendly name for the exclusion</li>
<li><strong>Event Type Like</strong> - the event that you would like to exclude, note that it
  takes wildcards so the <strong>%_DATABASE</strong> will match the <strong>CREATE_DATABASE</strong>,
  <strong>ALTER_DATABASE</strong> and <strong>DROP_DATABASE</strong> events.</li>
<li><strong>Login/Database/Schema/Object Name Like</strong> - here we can finely tune which
  objects to exclude</li>
<li><strong>Is Active</strong> - toggle the exclusion on or off</li>
</ul>
<p>In the example, I am excluding the dropping, creating or altering of the
database "Staging"</p>
<p>Click on the <strong>Save</strong> button to save the exclusion.</p>
<h1 id="system-settings">System Settings</h1>
<p>Here you can edit schedules and retention periods for the Server Activity Audit
report</p>
<p><img alt="" src="../../../img/reports/audit-history/audit-history-report-system-settings.png" /></p>
<ul>
<li><strong>Query Schedule</strong> - The frequency to connect to all the server instances to
  get Audit changes</li>
<li><strong>Email Schedule</strong> - All alerts currently share a single email schedule that
  can be adjusted here</li>
<li><strong>Archive Schedule</strong> - How often to remove audit data that has exceeded the
  <strong>History Retention Period (in Days)</strong></li>
<li><strong>History Retention Period (In Days)</strong> - the number of days to keep the audit
  data</li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../health-report/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../health-report/" class="btn btn-xs btn-link">
        Health Report
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../overview/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../overview/" class="btn btn-xs btn-link">
        Overview
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content"><p>Copyright © 2022 EnterpriseWorx, maintained by the Conductor4SQL team.</p>
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>