<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../..../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Query Editor - ConductorSQLPro Technical Documentation</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Query Editor", url: "#_top", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../js/custom.js"></script>
      <script src="../../../search/main.js"></script> 
<link rel="stylesheet" href="../../../css/jquery.fancybox.css" type="text/css" defer />
<script src="../../../js/jquery.fancybox.js" defer></script>
<script src="../../../js/jquery.fancybox.pack.js" defer></script>
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../query-schedule/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../query-schedule/" class="btn btn-xs btn-link">
        Query Schedule
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../overview/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../overview/" class="btn btn-xs btn-link">
        Overview
      </a>
    </div>
    
  </div>

    

    <h1 id="query-editor">Query Editor</h1>
<p>To run a query over multiple instances, open up the <strong>Query Editor</strong> screen.</p>
<p><img alt="" src="../../../img/queries/user-query/query-editor.png" /></p>
<p>The <strong>Query Editor</strong> pretty much works in the same way as composing an email but with SQL scripts and the <strong>To Instances</strong> chips being the instances and groups in which to execute the script against.</p>
<ul>
<li><strong>To Instance:</strong> This is where you would insert all the instances or instance groups you would like to send the query to.</li>
<li><strong>Description:</strong> Used to discern the query in the User Query History, scheduled queries and list of saved queries.</li>
<li><strong>Transactional:</strong> Toggle whether to run the entire script below in a SQL Transaction or not.</li>
<li><strong>Use Database:</strong> (optional) The name of the database(s) to run the script against.</li>
<li><strong>Table Name:</strong> (optional) The name of the table to save the results of the first query result set.</li>
<li><strong>Time to live:</strong> Set the length of time that the query is valid for.</li>
<li><strong>Script Body:</strong> SQL query code.</li>
</ul>
<p>Press the <strong>Execute</strong> button once you are ready to at the top right which will take you to a screen to view the results query results.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can provide a list of databases and you can use wildcards in the <strong>Use Database</strong> field e.g. 'master,POS%'</p>
<p>In the above example the databases master, POS and POS001 will be matched and the script will be run against these databases.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can use GO statements in the <strong>Script Body</strong> and run almost any script that you would run in SQL Server Management Studio.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you save your results to table, you can build PowerBI and Qlikview reports on that table's data</p>
</div>
<p><img alt="" src="../../../img/queries/user-query/query-editor-functions.png" /></p>
<p>The results screen shows how the query executed against each instance.</p>
<p>The possible statuses of <strong>Status</strong> column:</p>
<ul>
<li><strong>Pending:</strong> - the query hasn't executed against this instance yet</li>
<li><strong>Complete:</strong> - the query has run and was successful</li>
<li><strong>Error:</strong> - SQLPro tried to connect to the instance and there was an error (common issue is no comms)</li>
<li><strong>Complete With Error:</strong> - the query ran but there was a SQL error</li>
<li><strong>Cancelled:</strong> - the query was cancelled by one of the users</li>
<li><strong>Timed Out:</strong> - the query exceeded the time to live time and was cancelled by the system.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are not saving the results to a table, you can view the results of the query consolidated into a single view by clicking on the <strong>Result Set x</strong> tab that you wish to view.</p>
<p>You can also view any of the SQL errors that occured by selecting <strong>Errors</strong> tab</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This screen does not auto refresh. Click on the <strong>Refresh</strong> button to refresh the results on the screen.</p>
</div>
<p><img alt="" src="../../../img/queries/user-query/query-editor-results-refresh.png" /></p>
<p>You will then have the ability to save the specific query for later use and/or schedule the query.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong><a href="../user-query-history/">User Query History</a></strong> screen comes in handy when you want to save a previous query that had been run.</p>
</div>
<p>From the <strong>Query Editor</strong> page queries can be saved and edited so as to automate the reporting process. After a query has been saved you can view them in the <strong>Saved Query History</strong> page which will give you the option to edit, load and delete a query.</p>
<p><img alt="" src="../../../img/queries/saved-queries/saved-queries-screen.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When loading a query you're query editor will be populated with all the saved data whereas when you want to edit a query an edit screen will pop up and you will be able to make changes.</p>
</div>
<p>The visibility tab refers to who can view your saved queries ie. if you are not able to do work and need someone to fill in for the day.</p>
<p><img alt="" src="../../../img/queries/saved-queries/saved-queries-edit.png" /></p>
<p>At the bottom of the <strong>Edit query</strong> pop up you will find the ability to assign schedules to your query. You can make predetermined schedules and will take notice that the name of the schedule is used to assign it below. If the results of the query need to be emailed tick the <strong>Email Results</strong> toggle. To add additional schedules select the <strong>Add Schedule</strong> option at the bottom of the list of schedules. To edit a schedule go to the <a href="../query-schedule/"><strong>Query Schedule</strong></a> page.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>More than one schedule can be added to your database and you can find how many queries use a schedule on the <strong>Scheduler</strong> page.</p>
</div>
<p><img alt="" src="../../../img/queries/saved-queries/saved-queries-schedule.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../query-schedule/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../query-schedule/" class="btn btn-xs btn-link">
        Query Schedule
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../overview/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../overview/" class="btn btn-xs btn-link">
        Overview
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content"><p>Copyright Â© 2022 EnterpriseWorx, maintained by the Conductor4SQL team.</p>
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>